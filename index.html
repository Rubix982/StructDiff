<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSON Structure Comparer</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.39.0/min/vs/loader.min.js"></script>
    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="css/editor.css" />
  </head>
  <body>
    <h1>JSON Structure Comparer</h1>
    <div id="editorContainer">
      <div id="editor1" class="editor"></div>
      <div id="editor2" class="editor"></div>
    </div>
    <button id="compareButton">Compare JSONs</button>
    <div id="charts">
      <div id="tree1" style="width: 50%; height: 600px; float: left;"></div>
      <div id="tree2" style="width: 50%; height: 600px; float: left;"></div>
    </div>
    <div id="nodeDetails">
      <strong>Node Details:</strong> <span id="details"></span>
    </div>    
    <script src="js/utils.js"></script>
    <script src="js/index.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/qunit/qunit-2.16.0.js"></script>
    
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    
    <script>
      QUnit.test("JSON Parsing", function(assert) {
        const json1 = '{"name": "test"}';
        const json2 = '{"age": 25}';
    
        let parsed1, parsed2;
        try {
          parsed1 = JSON.parse(json1);
          parsed2 = JSON.parse(json2);
        } catch (error) {
          assert.ok(false, "JSON parsing failed");
        }
        assert.deepEqual(parsed1, { name: "test" }, "Parsed JSON1 correctly");
        assert.deepEqual(parsed2, { age: 25 }, "Parsed JSON2 correctly");
      });
    
      QUnit.test("Tree Creation", function(assert) {
        const data = { a: 1, b: { c: 2 } };
        const expected = [
          { name: "a", value: 1, children: [], source: "json1", _collapsed: true },
          {
            name: "b",
            value: { c: 2 },
            children: [{ name: "c", value: 2, children: [], source: "json1", _collapsed: true }],
            source: "json1",
            _collapsed: true,
          },
        ];
    
        const result = createTree(data, "json1");
        assert.deepEqual(result, expected, "Tree structure created correctly");
      });
    </script>    
  </body>
</html>
